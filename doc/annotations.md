## Annotation

### [@Cache](../autoload-cache-common/src/main/java/com/jarvis/cache/annotation/Cache.java "@Cache")


```java

public interface UserMapper {

    /**
     * Get user information based on user id
     *
     * @param id
     * @return
     */
    @Cache(expire = 60, expireExpression = "null == #retVal ? 30: 60", key = "'user-byid-' + #args[0]")
    UserDO getUserById(Long id);

    @Cache(expire = 60, expireExpression = "null == #retVal ? 30: 60",
            // Because parameters are separated in Magic mode, #args[0] is used to take parameters.
            // If the parameter data is a complex type, such as List<UserDO>, then use #args[0].id for the parameter
            // In order to reduce the problem of caching, some key values ​​must be the same as those of the getUserById method
            key = "'user-byid-' + #args[0]",
            magic = @Magic(
                    // Because the data of array and collection types are separated in Magic mode, #retVal is used for the return value.
                    // The value generated by this key expression must also be the same as that of the getUserById method
                    key = "'user-byid-' + #retVal.id"))
    List<UserDO> listByIds(@Param("ids") List<Long> ids);

    /**
     * Get a list of user ids based on dynamic combination query conditions
     *
     * @param condition
     * @return
     **/
    List<Long> listIdsByCondition(UserCondition condition);

    /**
     * Add user information
     *
     * @param user
     */
    @CacheDelete({ @CacheDeleteKey(value = "'user-byid-' + #args[0].id") })
    int addUser(UserDO user);

    /**
     * Update user information
     *
     * @param user
     * @return
     */
    @CacheDelete({ @CacheDeleteKey(value = "'user-byid-' + #args[0].id", condition = "#retVal > 0") })
    int updateUser(UserDO user);

    /**
     * Delete user records based on user id
     **/
    @CacheDelete({ @CacheDeleteKey(value = "'user-byid-' + #args[0]", condition = "#retVal > 0") })
    int deleteUserById(Long id);

}

```


### [@ExCache](../autoload-cache-common/src/main/java/com/jarvis/cache/annotation/ExCache.java "@ExCache")


Example of usage scenario: If the system uses getUserById and getUserByName, two methods to obtain user information, we can also generate the cache of getUserByName during getUserById. Conversely, when getUserByName is used, the cache of getUserById can also be generated:

```java
@Cache(expire=600, key="'USER.getUserById'+#args[0]", exCache={@ExCache(expire=600, key="'USER.getUserByName'+#retVal.name")})
public User getUserById(Long id){... ...}

@Cache(expire=600, key="'USER.getUserByName'+#args[0]", exCache={@ExCache(expire=600, key="'USER.getUserById'+#retVal.id")})
public User getUserByName(Long id){... ...}
``` 


### [@CacheDelete](../autoload-cache-common/src/main/java/com/jarvis/cache/annotation/CacheDelete.java "@CacheDelete") delete cache annotation

### [@CacheDeleteKey](../autoload-cache-common/src/main/java/com/jarvis/cache/annotation/CacheDeleteKey.java "@CacheDeleteKey") Generate delete cache key annotation

### [@CacheDeleteTransactional](../autoload-cache-common/src/main/java/com/jarvis/cache/annotation/CacheDeleteTransactional.java "@CacheDeleteTransactional") Batch delete cache annotations in transaction environment

### [@LocalCache](../autoload-cache-common/src/main/java/com/jarvis/cache/annotation/LocalCache.java "@LocalCache") local cache annotation